// /entities/news/model/newsStorage.js

import img1 from "../../../assets/img/door.jpeg";
import img2 from "../../../assets/img/tree.jpeg";
import img3 from "../../../assets/img/study.jpeg";

const NEWS_KEY = "news";

/**
 * ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (Ğ¼Ğ¾ĞºĞ¸).
 * Ğ•ÑĞ»Ğ¸ Ğ² localStorage Ğ½ĞµÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ñ‹Ñ… Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ĞµĞ¹,
 * Ğ¾Ğ½Ğ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ·Ğ°Ğ¿Ğ¸ÑĞ°Ğ½Ñ‹ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğ¸ Ğº getAllNews().
 */
const initialNews = [
    {
        id: "1",
        author: "Ğ˜Ğ¼ĞµĞ½Ğ¾Ğ²Ğ° Ğ¡ĞµĞ²Ğ°Ñ€Ğ°",
        role: "student",
        title: "ĞĞ°Ñˆ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚ â€” Ğ½Ğ°ÑˆĞ° Ğ·Ğ°Ğ±Ğ¾Ñ‚Ğ°!",
        content: "Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ, Ğ² 10:30 ÑƒÑ‚Ñ€Ğ°, Ğ½Ğ° Ñ‚ĞµÑ€Ñ€Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ½Ğ°ÑˆĞµĞ³Ğ¾ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ° Ğ¿Ñ€Ğ¾ÑˆÑ‘Ğ» ÑÑƒĞ±Ğ±Ğ¾Ñ‚Ğ½Ğ¸Ğº. Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹ Ğ¸ Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½Ğ¸Ğ»Ğ¸ÑÑŒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ ĞºĞ°Ğ¼Ğ¿ÑƒÑ Ñ‡Ğ¸Ñ‰Ğµ Ğ¸ ÑƒÑÑ‚Ğ½ĞµĞµ. Ğ£Ğ±Ğ¸Ñ€Ğ°Ğ»Ğ¸ Ğ»Ğ¸ÑÑ‚ÑŒÑ, ĞºÑ€Ğ°ÑĞ¸Ğ»Ğ¸ Ğ»Ğ°Ğ²Ğ¾Ñ‡ĞºĞ¸, Ğ²Ñ‹ÑĞ°Ğ¶Ğ¸Ğ²Ğ°Ğ»Ğ¸ Ñ†Ğ²ĞµÑ‚Ñ‹ â€” Ğ¿Ğ¾Ğ³Ğ¾Ğ´Ğ°, Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ğµ Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ¿Ğ¾Ñ€Ğ°Ğ´Ğ¾Ğ²Ğ°Ğ»Ğ¸ Ğ²ÑĞµÑ… ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¾Ğ²!\n" +
          "ĞĞ³Ñ€Ğ¾Ğ¼Ğ½Ğ¾Ğµ ÑĞ¿Ğ°ÑĞ¸Ğ±Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼Ñƒ, ĞºÑ‚Ğ¾ Ğ½Ğµ Ğ¾ÑÑ‚Ğ°Ğ»ÑÑ Ğ² ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğµ â€” Ñ‚Ğ°ĞºĞ¸Ğµ Ğ¼ĞµÑ€Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ Ğ½Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑƒĞºÑ€Ğ°ÑˆĞ°ÑÑ‚ Ğ½Ğ°Ñˆ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚, Ğ½Ğ¾ Ğ¸ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ÑÑÑ‚ Ğ½Ğ°Ñ!",
        createdAt: "2023-03-10T09:00:00.000Z",
        image: img2,
    },
    {
        id: "2",
        author: "Ğ£Ñ‡Ğ¸Ñ‚ĞµĞ»ÑŒ",
        role: "teacher",
        title: "Ğ¡ĞºĞ¾Ñ€Ğ¾ Ğ½Ğ°Ñ‡Ğ½ĞµÑ‚ÑÑ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ Ğ½ĞµĞ´ĞµĞ»Ñ",
        content: "Ğ”Ñ€ÑƒĞ·ÑŒÑ, ÑĞ¾Ğ²ÑĞµĞ¼ ÑĞºĞ¾Ñ€Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚ÑƒĞµÑ‚ ÑĞºĞ·Ğ°Ğ¼ĞµĞ½Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ Ğ½ĞµĞ´ĞµĞ»Ñ â€” Ğ²Ñ€ĞµĞ¼Ñ ÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒÑÑ, Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ» Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑÑ‘, Ğ½Ğ° Ñ‡Ñ‚Ğ¾ Ğ¼Ñ‹ ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ñ‹!\n" +
          "ĞĞµ Ğ·Ğ°Ğ±Ñ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ¿Ñ€Ğ¾ Ñ€ĞµĞ¶Ğ¸Ğ¼ ÑĞ½Ğ°, Ğ¾Ñ‚Ğ´Ñ‹Ñ… Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºÑƒ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ°. Ğ£Ğ´Ğ°Ñ‡Ğ¸ Ğ²ÑĞµĞ¼ â€” Ğ¿ÑƒÑÑ‚ÑŒ Ğ±Ğ¸Ğ»ĞµÑ‚Ñ‹ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ»Ñ‘Ğ³ĞºĞ¸Ğ¼Ğ¸, Ğ° Ğ¾Ñ†ĞµĞ½ĞºĞ¸ â€” Ğ²Ñ‹ÑĞ¾ĞºĞ¸Ğ¼Ğ¸!",
        createdAt: "2023-03-15T15:30:00.000Z",
        image: img3,
    },
    {
        id: "2",
        author: "Ğ£Ñ‡Ğ¸Ñ‚ĞµĞ»ÑŒ",
        role: "teacher",
        title: "ĞŸÑ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞ°ĞµĞ¼ Ğ²ÑĞµÑ… Ğ½Ğ° Ğ´ĞµĞ½ÑŒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ğ´Ğ²ĞµÑ€ĞµĞ¹!",
        content: "ĞŸÑ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸ Ğ½Ğ° Ğ”ĞµĞ½ÑŒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ğ´Ğ²ĞµÑ€ĞµĞ¹ Ğ¸ Ğ¾ĞºÑƒĞ½Ğ¸ÑÑŒ Ğ² Ğ°Ñ‚Ğ¼Ğ¾ÑÑ„ĞµÑ€Ñƒ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚ÑĞºĞ¾Ğ¹ Ğ¶Ğ¸Ğ·Ğ½Ğ¸!\n" +
          "\n" +
          "ğŸ“Œ Ğ§Ñ‚Ğ¾ Ñ‚ĞµĞ±Ñ Ğ¶Ğ´Ñ‘Ñ‚:\n" +
          "â€” Ğ—Ğ½Ğ°ĞºĞ¾Ğ¼ÑÑ‚Ğ²Ğ¾ Ñ Ñ„Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ğ°Ğ¼Ğ¸ Ğ¸ Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸\n" +
          "â€” Ğ­ĞºÑĞºÑƒÑ€ÑĞ¸Ñ Ğ¿Ğ¾ ĞºĞ°Ğ¼Ğ¿ÑƒÑÑƒ\n" +
          "â€” ĞÑ‚Ğ²ĞµÑ‚Ñ‹ Ğ½Ğ° Ğ²ÑĞµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¾ Ğ¿Ğ¾ÑÑ‚ÑƒĞ¿Ğ»ĞµĞ½Ğ¸Ğ¸\n" +
          "â€” Ğ–Ğ¸Ğ²Ğ¾Ğµ Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ñ Ğ½Ğ°ÑˆĞ¸Ğ¼Ğ¸ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸\n" +
          "\n" +
          "ğŸ“… ĞšĞ¾Ğ³Ğ´Ğ°: 20.06.2025\n" +
          "ğŸ•’ Ğ’Ğ¾ ÑĞºĞ¾Ğ»ÑŒĞºĞ¾:13:00\n" +
          "ğŸ“ Ğ“Ğ´Ğµ: Ğ¿Ñ€Ğ¾ÑĞ¿ĞµĞºÑ‚ Ğ§ÑƒĞ¹, 255\n" +
          "\n" +
          "ĞĞµ ÑƒĞ¿ÑƒÑÑ‚Ğ¸ ÑˆĞ°Ğ½Ñ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ ÑˆĞ°Ğ³ Ğ½Ğ°Ğ²ÑÑ‚Ñ€ĞµÑ‡Ñƒ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¼Ñƒ! Ğ–Ğ´Ñ‘Ğ¼ Ñ‚ĞµĞ±Ñ â€” Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ğ¾",
        createdAt: "2023-03-15T15:30:00.000Z",
        image: img1,
    },
];

/**
 * Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ĞµĞ¹ Ğ² localStorage Ğ¿Ğ¾ ĞºĞ»ÑÑ‡Ñƒ NEWS_KEY.
 * @param {Array} list - Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ĞµĞ¹
 */
function saveNewsList(list) {
    localStorage.setItem(NEWS_KEY, JSON.stringify(list));
}

/**
 * ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸ Ğ¸Ğ· localStorage.
 * Ğ•ÑĞ»Ğ¸ Ñ‚Ğ°Ğ¼ Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ½ĞµÑ‚, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ¼Ğ°ÑÑĞ¸Ğ² initialNews,
 * ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ² localStorage Ğ¸ Ğ·Ğ°Ñ‚ĞµĞ¼ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ.
 * @returns {Array} ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ĞµĞ¹
 */
export function getAllNews() {
    const data = localStorage.getItem(NEWS_KEY);
    if (!data) {
        saveNewsList(initialNews);
        return initialNews;
    }
    try {
        return JSON.parse(data);
    } catch (e) {
        console.error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° news Ğ¸Ğ· localStorage", e);
        return [];
    }
}

/**
 * Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ² localStorage.
 * @param {Object} newsData - Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸
 * @returns {Object} ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ğ°Ñ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ (Ñ Ğ¿Ñ€Ğ¸ÑĞ²Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¼ id)
 */
export function createNews(newsData) {
    const list = getAllNews();
    const newId = String(Date.now()); // Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğµ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
    const newPost = {
        id: newId,
        ...newsData,
    };
    // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ¼ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ Ğ² Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ ÑĞ¿Ğ¸ÑĞºĞ°:
    list.unshift(newPost);
    saveNewsList(list);
    return newPost;
}

/**
 * ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ.
 * @param {string} id - Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸
 * @param {Object} updates - Ğ¿Ğ¾Ğ»Ñ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ
 * @returns {Object|null} Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»Ñ‘Ğ½Ğ½Ğ°Ñ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ Ğ¸Ğ»Ğ¸ null, ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°
 */
export function updateNews(id, updates) {
    const list = getAllNews();
    const index = list.findIndex((item) => item.id === id);
    if (index === -1) {
        console.warn(`ĞĞ¾Ğ²Ğ¾ÑÑ‚ÑŒ Ñ id=${id} Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°`);
        return null;
    }
    list[index] = { ...list[index], ...updates };
    saveNewsList(list);
    return list[index];
}

/**
 * Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ ĞµÑ‘ id.
 * @param {string} id - Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚Ğ¸
 */
export function deleteNews(id) {
    let list = getAllNews();
    list = list.filter((item) => item.id !== id);
    saveNewsList(list);
}
